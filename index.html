<!DOCTYPE html>
<html>
<head>
    <title>Github to Loadstring</title>
    <meta charset="UTF-8">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: monospace; }
        body { background: #0a0a0a; color: #0f0; padding: 10px; font-size: 12px; }
        .container { max-width: 600px; margin: auto; }
        h1 { color: #0f0; font-size: 14px; margin-bottom: 10px; text-align: center; }
        .box { background: #111; border: 1px solid #333; padding: 10px; margin: 10px 0; }
        textarea, input { width: 100%; background: #000; color: #0f0; border: 1px solid #333; padding: 8px; font-size: 11px; }
        button { background: #003300; color: #0f0; border: 1px solid #00aa00; padding: 8px; cursor: pointer; width: 100%; margin: 5px 0; }
        button:hover { background: #005500; }
        .loadstring { background: #001100; padding: 8px; margin: 5px 0; word-break: break-all; font-size: 10px; }
        .info { color: #888; font-size: 10px; margin-top: 5px; }
        .warning { color: #ff0; }
        .error { color: #f00; }
    </style>
</head>
<body>
    <div class="container">
        <h1>ðŸ”„ GITHUB TO LOADSTRING (MINI)</h1>
        
        <div class="box">
            <b>1. PASTE GITHUB RAW URL:</b>
            <input type="text" id="githubUrl" placeholder="https://raw.githubusercontent.com/.../script.lua">
            <button onclick="convertUrl()">CONVERT TO LOADSTRING</button>
        </div>
        
        <div class="box">
            <b>2. ATAU PASTE CODE LANGSUNG:</b>
            <textarea id="directCode" rows="6" placeholder="Paste script di sini..."></textarea>
            <button onclick="convertCode()">GENERATE LOADSTRING</button>
        </div>
        
        <div class="box">
            <b>3. HASIL LOADSTRING (Auto-copy):</b>
            <div class="loadstring" id="result"></div>
            <div class="info">Length: <span id="length">0</span> chars | Github-safe: <span id="safe">âœ“</span></div>
            <button onclick="testLoadstring()" style="background:#000055;">ðŸ”§ TEST LOADSTRING</button>
        </div>
        
        <div class="box">
            <b>âš™ SETTINGS:</b><br>
            <label><input type="checkbox" id="minify" checked> Minify (hapus spasi berlebih)</label><br>
            <label><input type="checkbox" id="base64" checked> Encode Base64</label><br>
            <div class="info">Output format: loadstring(game:HttpGet("URL_ATAU_BASE64"))()</div>
        </div>
        
        <div class="box warning">
            <b>âš  CATATAN:</b>
            <div class="info">â€¢ Max ~500 karakter untuk commit message GitHub</div>
            <div class="info">â€¢ Raw URL langsung jadi loadstring tanpa download</div>
            <div class="info">â€¢ Semua eksekusi tanggung jawab pengguna</div>
        </div>
    </div>

<script>
// Simpan history di localStorage
let history = JSON.parse(localStorage.getItem('gh_loadstring_history')) || [];

function convertUrl() {
    const url = document.getElementById('githubUrl').value.trim();
    if (!url) return alert('Masukkan URL!');
    
    // Cek apakah sudah raw github
    let loadstring = '';
    if (url.includes('raw.githubusercontent.com')) {
        // Langsung pakai raw URL
        loadstring = `loadstring(game:HttpGet("${url}"))()`;
    } else if (url.includes('github.com')) {
        // Convert ke raw
        const rawUrl = url.replace('github.com', 'raw.githubusercontent.com').replace('/blob/', '/');
        loadstring = `loadstring(game:HttpGet("${rawUrl}"))()`;
    } else if (url.includes('pastebin.com')) {
        // Support pastebin
        const pasteId = url.split('/').pop();
        loadstring = `loadstring(game:HttpGet("https://pastebin.com/raw/${pasteId}"))()`;
    } else {
        // URL biasa
        loadstring = `loadstring(game:HttpGet("${url}"))()`;
    }
    
    showResult(loadstring);
    saveToHistory(url, loadstring);
}

function convertCode() {
    const code = document.getElementById('directCode').value.trim();
    if (!code) return alert('Masukkan code!');
    
    const minify = document.getElementById('minify').checked;
    const useBase64 = document.getElementById('base64').checked;
    
    let processedCode = code;
    
    // Minify
    if (minify) {
        processedCode = code.replace(/--\[\[[\s\S]*?\]\]/g, '') // Hapus multi-line comments
                           .replace(/--.*$/gm, '') // Hapus single-line comments
                           .replace(/\s+/g, ' ') // Hapus spasi berlebihan
                           .trim();
    }
    
    let loadstring = '';
    if (useBase64) {
        // Encode ke base64
        const base64 = btoa(unescape(encodeURIComponent(processedCode)));
        loadstring = `loadstring(game:HttpGet("data:text/plain;base64,${base64}"))()`;
    } else {
        // Langsung embed
        loadstring = `loadstring("${processedCode.replace(/"/g, '\\"').replace(/\n/g, '\\n')}")()`;
    }
    
    showResult(loadstring);
    saveToHistory('direct_code', loadstring);
}

function showResult(loadstring) {
    const resultDiv = document.getElementById('result');
    const lengthSpan = document.getElementById('length');
    const safeSpan = document.getElementById('safe');
    
    resultDiv.textContent = loadstring;
    lengthSpan.textContent = loadstring.length;
    safeSpan.textContent = loadstring.length <= 450 ? 'âœ“' : 'âœ— (terlalu panjang)';
    
    // Auto-copy ke clipboard
    navigator.clipboard.writeText(loadstring).then(() => {
        resultDiv.style.border = '1px solid #0f0';
        setTimeout(() => resultDiv.style.border = 'none', 1000);
    });
}

function testLoadstring() {
    const loadstring = document.getElementById('result').textContent;
    if (!loadstring) return alert('Generate dulu!');
    
    const testWin = window.open('', '_blank');
    testWin.document.write(`
        <html><body style="background:#000;color:#0f0;font-family:monospace;padding:20px;">
        <h3>Loadstring Test:</h3>
        <div style="background:#111;padding:10px;margin:10px 0;">
        ${loadstring}
        </div>
        <div style="color:#ff0;">Simulasi: loadstring berhasil digenerate</div>
        </body></html>
    `);
}

function saveToHistory(source, loadstring) {
    history.unshift({
        source: source.length > 50 ? source.substring(0,50)+'...' : source,
        loadstring: loadstring,
        time: new Date().toLocaleTimeString(),
        length: loadstring.length
    });
    
    if (history.length > 10) history = history.slice(0,10);
    localStorage.setItem('gh_loadstring_history', JSON.stringify(history));
}

// Load contoh URL
document.getElementById('githubUrl').value = 'https://raw.githubusercontent.com/tryoufrik-web/Uchub/refs/heads/main/Test1.Lua';

// Auto-convert saat halaman load
window.onload = function() {
    setTimeout(convertUrl, 500);
};
</script>
</body>
</html>
